!function(w){"use strict";w.module("ngLocationSearch",[]).directive("ngLocationSearch",["$log","$timeout","$location","$window","$parse","$httpParamSerializer",function(p,b,O,L,l,x){return{restrict:"A",require:["?ngModel","?^form"],link:function(d,n,v,e){var S,i=e[0],t=e[1];function m(n){return!!w.isString(n)&&n.replace(/\/$/,"")}function a(t){var a={},n=d.$eval(v.ngLocationSearchReset),e=m(v.ngLocationSearchUrl),i=m(L.location.href.replace(L.location.hash,""));try{var o=w.fromJson(t);t=o}catch(n){}w.forEach(S,function(n,e){var i=null;w.isObject(t)&&w.isDefined(t[n])?i=t[n]:w.isString(t)&&(i=t),a[n]=""!==i?i:null});var r=O.search();if(n||(a=w.extend({},r,a)),w.isString(e)&&e!==i){var c=0!==e.indexOf("/"),l=-1!==e.indexOf("#!/")||-1!==e.indexOf("#/"),s=0===e.indexOf(O.protocol()),u=O.path(),f=m(L.location.hash.replace(O.url(),"")),h=x(a),$="";if(!O.$$html5||s)$=e+(h=h?"?"+h:""),!l&&s&&($=e+f+(u=u&&!O.$$html5?"/":"")+h),L.location.href=$;else{if(O.search(h),d.$apply(),c){var g=u.split("/");$=g[g.length-1]===e?u:u+"/"+e}else $=e;O.path($),d.$apply()}p.debug($)}else b(function(){O.search(a)})}if(v.ngLocationSearch&&(i||t)){S=d.$eval(v.ngLocationSearch),S=w.isArray(S)?S:[v.ngLocationSearch];var o=null,r=function(i){o=1<S.length?{}:null,w.forEach(S,function(n,e){w.isObject(o)?o[n]=w.isDefined(i[n])?i[n]:null:w.isDefined(i[n])&&(o=i[n])}),w.isObject(o)&&(o=w.toJson(o)),(0,l(v.ngModel).assign)(d,o)},c=function(i){if(0<S.length){var n=d.$eval(v.ngSubmit);o={},w.forEach(S,function(n,e){w.isDefined(i[n])&&(o[n]=i[n])}),n=w.isObject(n)?n:{},o=w.extend(n,o),(0,l(v.ngSubmit).assign)(d,o)}};i&&(d.$watch(function(){return i.$modelValue},function(n,e){n!==e&&i.$valid&&a(n)}),d.$on("$locationChangeStart",function(n,e,i,t,a){r(O.search())}),r(O.search())),t&&(n.on("submit",function(){var n=d.$eval(v.ngSubmit),e=d.$eval(v.name);!n||e&&!e.$valid||a(n)}),d.$on("$locationChangeStart",function(n,e,i,t,a){c(O.search())}),c(O.search()))}d.$on("$destroy",function(){w.isDefined(d[v.ngSubmit])&&delete d[v.ngSubmit]})}}}])}(window.angular);