!function(y){"use strict";y.module("ngLocationSearch",[]).directive("ngLocationSearch",["$rootScope","$log","$timeout","$location","$window","$parse","$httpParamSerializer",function(d,n,v,m,p,L,b){return{restrict:"A",require:["?ngModel","?^form"],link:function(g,n,i,e){function $(n){return!!y.isString(n)&&n.replace(/\/$/,"")}function r(n,e){switch(e){case"array":return y.isArray(n)?n:y.isString(n)&&0<n.length?n.split(","):null;case"number":return y.isNumber(n)?n:parseFloat(n);case"string":return y.isString(n)?n:null;default:return n}}var o,c=i.ngLocationSearchDefault?g.$eval(i.ngLocationSearchDefault):null,t=e[0],a=e[1],s=function(t){var s={},l=g.$eval(i.ngLocationSearchReplace),n=g.$eval(i.ngLocationSearchReset),h=i.ngLocationSearchUrl,u=p.location.href.replace(p.location.hash,""),e=i.ngLocationSearchDelay||0;try{var a=y.fromJson(t);t=a}catch(n){}y.forEach(o,function(n,e){var a=c;y.isObject(t)&&y.isDefined(t[n])?a=t[n]:y.isString(t)&&(a=t),y.isArray(a)&&(a=a.toString()),s[n]=a&&""!==a?a.toString():""===a?null:c});var f=m.search();n||(s=y.extend({},f,s)),y.equals(s,f)||(d.$broadcast("ngLocationSearchChangeStart",s,f),v(function(){if(y.isString(h)&&h!==u){var n=0!==h.indexOf("/"),e=-1!==h.indexOf("#!/")||-1!==h.indexOf("#/"),a=0===h.indexOf(m.protocol()),t=m.path(),r=$(p.location.hash.replace(m.url(),"")),i=b(s),o="";if(!m.$$html5||a)o=h+(i=i?"?"+i:""),!e&&a&&(t=t&&!m.$$html5?"/":"",o=h+r+t+i),p.location.href=o,m.search(s);else{if(m.search(i),l&&g.$apply(),n){var c=t.split("/");o=c[c.length-1]===h?t:t+"/"+h}else o=h;m.path(o),g.$apply()}}else m.search(s);d.$broadcast("ngLocationSearchChangeSuccess",s,f)},parseInt(e,10)))};if(i.ngLocationSearch&&(t||a)){o=g.$eval(i.ngLocationSearch),o=y.isArray(o)?o:[i.ngLocationSearch];var l,h,u,f=c,S=function(a){var t=i.ngLocationSearchTypes?g.$eval(i.ngLocationSearchTypes):{};f=1<o.length?{}:c,y.forEach(o,function(n,e){y.isObject(f)?f[n]=r(y.isDefined(a[n])?a[n]:c,t[n]):f=r(y.isDefined(a[n])?a[n]:c,t[n])}),y.isObject(f)&&(f=y.toJson(f)),(0,L(i.ngModel).assign)(g,f)};if(t&&(g.$watch(function(){return t.$modelValue},function(n,e){if(n!==e&&t.$valid)s(n);else{var a=i.name;d.$broadcast("ngLocationSearchChangeError","model",a,t)}}),g.$on("$locationChangeStart",function(n,e,a,t,r){S(m.search())}),S(m.search())),a)h=function(a){if(0<o.length){var n=g.$eval(i.ngSubmit),t=i.ngLocationSearchTypes?g.$eval(i.ngLocationSearchTypes):{};f={$resetForm:void 0},y.forEach(o,function(n,e){f[n]=r(y.isDefined(a[n])?a[n]:c,t[n]),f[n]&&(f.$resetForm=l)}),n=y.isObject(n)?n:{},f=y.extend(n,f),(0,L(i.ngSubmit).assign)(g,f)}},u=function(n,e){var a=y.isDefined(e)?e:g.$eval(i.ngSubmit),t=i.name,r=g.$eval(t);!y.isDefined(a)||r&&!r.$valid?d.$broadcast("ngLocationSearchChangeError","form",t,r):s(a)},l=function(){u(0,null)},n.on("submit",u),g.$on("$locationChangeStart",function(n,e,a,t,r){h(m.search())}),h(m.search())}g.$on("$destroy",function(){y.isDefined(g[i.ngSubmit])&&delete g[i.ngSubmit]})}}}])}(window.angular);