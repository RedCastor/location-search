!function(x){"use strict";x.module("ngLocationSearch",[]).directive("ngLocationSearch",["$log","$timeout","$location","$window","$parse","$httpParamSerializer",function(v,p,b,O,l,L){return{restrict:"A",require:["?ngModel","?^form"],link:function($,n,d,e){var S,i=e[0],t=e[1];function m(n){return!!x.isString(n)&&n.replace(/\/$/,"")}function a(t){var a={},n=$.$eval(d.ngLocationSearchReset),e=m(d.ngLocationSearchUrl),i=m(O.location.href.replace(O.location.hash,"")),o=0===e.indexOf("/"),c=-1!==e.indexOf("#!/")||-1!==e.indexOf("#/"),r=0===e.indexOf(b.protocol());try{var l=x.fromJson(t);t=l}catch(n){}x.forEach(S,function(n,e){var i=null;x.isObject(t)&&x.isDefined(t[n])?i=t[n]:x.isString(t)&&(i=t),a[n]=""!==i?i:null});var u=b.search();if(n||(a=x.extend({},u,a)),x.isString(e)&&e!==i){var f=b.path(),s=m(O.location.hash.replace(b.url(),"")),h=L(a),g="";!b.$$html5||r?(g=e+(h=h?"?"+h:""),!c&&r&&(g=e+s+(f=f&&!b.$$html5?"/":"")+h),O.location.href=g):(b.search(h),$.$apply(),g=o?e:f+"/"+e,b.path(g),$.$apply()),v.debug(g)}else p(function(){b.search(a)})}if(d.ngLocationSearch&&(i||t)){S=$.$eval(d.ngLocationSearch),S=x.isArray(S)?S:[d.ngLocationSearch];var o=null,c=function(i){o=1<S.length?{}:null,x.forEach(S,function(n,e){x.isObject(o)?o[n]=x.isDefined(i[n])?i[n]:null:x.isDefined(i[n])&&(o=i[n])}),x.isObject(o)&&(o=x.toJson(o)),(0,l(d.ngModel).assign)($,o)},r=function(i){if(0<S.length){var n=$.$eval(d.ngSubmit);o={},x.forEach(S,function(n,e){x.isDefined(i[n])&&(o[n]=i[n])}),n=x.isObject(n)?n:{},o=x.extend(n,o),(0,l(d.ngSubmit).assign)($,o)}};i&&($.$watch(function(){return i.$modelValue},function(n,e){n!==e&&a(n)}),$.$on("$locationChangeStart",function(n,e,i,t,a){c(b.search())}),c(b.search())),t&&(n.on("submit",function(){var n=$.$eval(d.ngSubmit);n&&a(n)}),$.$on("$locationChangeStart",function(n,e,i,t,a){r(b.search())}),r(b.search()))}$.$on("$destroy",function(){x.isDefined($[d.ngSubmit])&&delete $[d.ngSubmit]})}}}])}(window.angular);