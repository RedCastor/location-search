!function(w){"use strict";w.module("ngLocationSearch",[]).directive("ngLocationSearch",["$log","$timeout","$location","$window","$parse","$httpParamSerializer",function(v,b,p,O,l,L){return{restrict:"A",require:["?ngModel","?^form"],link:function($,n,d,i){var S,e=i[0],t=i[1];function m(n){return!!w.isString(n)&&n.replace(/\/$/,"")}function o(t){var o={},n=$.$eval(d.ngLocationSearchReset),i=m(d.ngLocationSearchUrl),e=m(O.location.href.replace(O.location.hash,"")),a=0===i.indexOf("/"),c=-1!==i.indexOf("#!/")||-1!==i.indexOf("#/"),r=0===i.indexOf(p.protocol());try{var l=w.fromJson(t);t=l}catch(n){}w.forEach(S,function(n,i){var e=null;w.isObject(t)&&w.isDefined(t[n])?e=t[n]:w.isString(t)&&(e=t),o[n]=""!==e?e:null});var u=p.search();if(n||(o=w.extend({},u,o)),w.isString(i)&&i!==e){var f=p.path(),s=m(O.location.hash.replace(p.url(),"")),h=L(o),g="";!p.$$html5||r?(g=i+(h=h?"?"+h:""),!c&&r&&(g=i+s+(f=f&&!p.$$html5?"/":"")+h),O.location.href=g):(p.search(h),$.$apply(),g=a?i:f+"/"+i,p.path(g),$.$apply()),v.debug(g)}else b(function(){p.search(o)})}if(d.ngLocationSearch&&(e||t)){S=$.$eval(d.ngLocationSearch),S=w.isArray(S)?S:[d.ngLocationSearch];var a=null,c=function(e){a=1<S.length?{}:null,w.forEach(S,function(n,i){w.isObject(a)?a[n]=w.isDefined(e[n])?e[n]:null:w.isDefined(e[n])&&(a=e[n])}),w.isObject(a)&&(a=w.toJson(a)),(0,l(d.ngModel).assign)($,a)},r=function(e){var n=$.$eval(d.ngSubmit);!n&&w.isObject(n)||(w.isUndefined($[d.ngSubmit])&&($[d.ngSubmit]={}),w.forEach(S,function(n,i){w.isDefined(e[n])&&($[d.ngSubmit][n]=e[n])}))};e&&($.$watch(function(){return e.$modelValue},function(n,i){n!==i&&o(n)}),$.$on("$locationChangeStart",function(n,i,e,t,o){c(p.search())}),c(p.search())),t&&(n.on("submit",function(){var n=$.$eval(d.ngSubmit);n&&o(n)}),$.$on("$locationChangeStart",function(n,i,e,t,o){r(p.search())}),r(p.search()))}$.$on("$destroy",function(){w.isDefined($[d.ngSubmit])&&delete $[d.ngSubmit]})}}}])}(window.angular);