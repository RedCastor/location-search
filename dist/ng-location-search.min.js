!function(y){"use strict";y.module("ngLocationSearch",[]).directive("ngLocationSearch",["$log","$timeout","$location","$window","$parse","$httpParamSerializer",function(b,L,O,x,l,w){return{restrict:"A",require:["?ngModel","?^form"],link:function(v,n,S,e){var m,i=e[0],t=e[1];function p(n){return!!y.isString(n)&&n.replace(/\/$/,"")}function a(t){var a={},n=v.$eval(S.ngLocationSearchReplace),e=v.$eval(S.ngLocationSearchReset),i=p(S.ngLocationSearchUrl),o=p(x.location.href.replace(x.location.hash,""));try{var c=y.fromJson(t);t=c}catch(n){}y.forEach(m,function(n,e){var i=null;y.isObject(t)&&y.isDefined(t[n])?i=t[n]:y.isString(t)&&(i=t),a[n]=""!==i?i:null});var r=O.search();if(e||(a=y.extend({},r,a)),y.isString(i)&&i!==o){var l=0!==i.indexOf("/"),s=-1!==i.indexOf("#!/")||-1!==i.indexOf("#/"),u=0===i.indexOf(O.protocol()),f=O.path(),h=p(x.location.hash.replace(O.url(),"")),$=w(a),g="";if(!O.$$html5||u)g=i+($=$?"?"+$:""),!s&&u&&(g=i+h+(f=f&&!O.$$html5?"/":"")+$),x.location.href=g;else{if(O.search($),n&&v.$apply(),l){var d=f.split("/");g=d[d.length-1]===i?f:f+"/"+i}else g=i;O.path(g),v.$apply()}b.debug(g)}else L(function(){O.search(a)})}if(S.ngLocationSearch&&(i||t)){m=v.$eval(S.ngLocationSearch),m=y.isArray(m)?m:[S.ngLocationSearch];var o=null,c=function(i){o=1<m.length?{}:null,y.forEach(m,function(n,e){y.isObject(o)?o[n]=y.isDefined(i[n])?i[n]:null:y.isDefined(i[n])&&(o=i[n])}),y.isObject(o)&&(o=y.toJson(o)),(0,l(S.ngModel).assign)(v,o)},r=function(i){if(0<m.length){var n=v.$eval(S.ngSubmit);o={},y.forEach(m,function(n,e){y.isDefined(i[n])&&(o[n]=i[n])}),n=y.isObject(n)?n:{},o=y.extend(n,o),(0,l(S.ngSubmit).assign)(v,o)}};i&&(v.$watch(function(){return i.$modelValue},function(n,e){n!==e&&i.$valid&&a(n)}),v.$on("$locationChangeStart",function(n,e,i,t,a){c(O.search())}),c(O.search())),t&&(n.on("submit",function(){var n=v.$eval(S.ngSubmit),e=v.$eval(S.name);!n||e&&!e.$valid||a(n)}),v.$on("$locationChangeStart",function(n,e,i,t,a){r(O.search())}),r(O.search()))}v.$on("$destroy",function(){y.isDefined(v[S.ngSubmit])&&delete v[S.ngSubmit]})}}}])}(window.angular);