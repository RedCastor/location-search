!function(D){"use strict";D.module("ngLocationSearch",[]).directive("ngLocationSearch",["$rootScope","$log","$timeout","$location","$window","$parse","$httpParamSerializer",function(b,L,O,x,w,l,y){return{restrict:"A",require:["?ngModel","?^form"],link:function(S,n,v,e){var m,a=e[0],i=e[1];function p(n){return!!D.isString(n)&&n.replace(/\/$/,"")}function t(i){var t={},n=S.$eval(v.ngLocationSearchReplace),e=S.$eval(v.ngLocationSearchReset),a=p(v.ngLocationSearchUrl),o=p(w.location.href.replace(w.location.hash,""));try{var c=D.fromJson(i);i=c}catch(n){}D.forEach(m,function(n,e){var a=null;D.isObject(i)&&D.isDefined(i[n])?a=i[n]:D.isString(i)&&(a=i),t[n]=""!==a?a.toString():null});var r=x.search();if(!D.equals(t,r)){if(e||(t=D.extend({},r,t)),b.$broadcast("ngLocationSearchChangeStart",r,t),D.isString(a)&&a!==o){var l=0!==a.indexOf("/"),s=-1!==a.indexOf("#!/")||-1!==a.indexOf("#/"),u=0===a.indexOf(x.protocol()),h=x.path(),f=p(w.location.hash.replace(x.url(),"")),g=y(t),$="";if(!x.$$html5||u)$=a+(g=g?"?"+g:""),!s&&u&&($=a+f+(h=h&&!x.$$html5?"/":"")+g),w.location.href=$;else{if(x.search(g),n&&S.$apply(),l){var d=h.split("/");$=d[d.length-1]===a?h:h+"/"+a}else $=a;x.path($),S.$apply()}L.debug($)}else O(function(){x.search(t)});b.$broadcast("ngLocationSearchChangeSuccess",r,t)}}if(v.ngLocationSearch&&(a||i)){m=S.$eval(v.ngLocationSearch),m=D.isArray(m)?m:[v.ngLocationSearch];var o=null,c=function(a){o=1<m.length?{}:null,D.forEach(m,function(n,e){D.isObject(o)?o[n]=D.isDefined(a[n])?a[n]:null:D.isDefined(a[n])&&(o=a[n])}),D.isObject(o)&&(o=D.toJson(o)),(0,l(v.ngModel).assign)(S,o)},r=function(a){if(0<m.length){var n=S.$eval(v.ngSubmit);o={},D.forEach(m,function(n,e){D.isDefined(a[n])&&(o[n]=a[n])}),n=D.isObject(n)?n:{},o=D.extend(n,o),(0,l(v.ngSubmit).assign)(S,o)}};a&&(S.$watch(function(){return a.$modelValue},function(n,e){n!==e&&a.$valid&&t(n)}),S.$on("$locationChangeStart",function(n,e,a,i,t){c(x.search())}),c(x.search())),i&&(n.on("submit",function(){var n=S.$eval(v.ngSubmit),e=S.$eval(v.name);!n||e&&!e.$valid||t(n)}),S.$on("$locationChangeStart",function(n,e,a,i,t){r(x.search())}),r(x.search()))}S.$on("$destroy",function(){D.isDefined(S[v.ngSubmit])&&delete S[v.ngSubmit]})}}}])}(window.angular);