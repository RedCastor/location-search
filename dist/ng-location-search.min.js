!function(y){"use strict";y.module("ngLocationSearch",[]).directive("ngLocationSearch",["$rootScope","$log","$timeout","$location","$window","$parse","$httpParamSerializer",function(p,L,O,C,x,l,w){return{restrict:"A",require:["?ngModel","?^form"],link:function(S,n,v,e){var m,o=e[0],a=e[1];function b(n){return!!y.isString(n)&&n.replace(/\/$/,"")}function t(o){var t={},n=S.$eval(v.ngLocationSearchReplace),e=S.$eval(v.ngLocationSearchReset),a=b(v.ngLocationSearchUrl),i=b(x.location.href.replace(x.location.hash,""));try{var c=y.fromJson(o);o=c}catch(n){}y.forEach(m,function(n,e){var a=null;y.isObject(o)&&y.isDefined(o[n])?a=o[n]:y.isString(o)&&(a=o),t[n]=a&&""!==a?a.toString():null});var r=C.search();if(e||(t=y.extend({},r,t)),!y.equals(t,r))if(p.$broadcast("ngLocationSearchChangeStart",t,r),y.isString(a)&&a!==i){var l=0!==a.indexOf("/"),s=-1!==a.indexOf("#!/")||-1!==a.indexOf("#/"),h=0===a.indexOf(C.protocol()),u=C.path(),f=b(x.location.hash.replace(C.url(),"")),g=w(t),$="";if(!C.$$html5||h)$=a+(g=g?"?"+g:""),!s&&h&&($=a+f+(u=u&&!C.$$html5?"/":"")+g),x.location.href=$;else{if(C.search(g),n&&S.$apply(),l){var d=u.split("/");$=d[d.length-1]===a?u:u+"/"+a}else $=a;C.path($),S.$apply()}L.debug($),p.$broadcast("ngLocationSearchChangeSuccess",t,r)}else O(function(){C.search(t),p.$broadcast("ngLocationSearchChangeSuccess",t,r)})}if(v.ngLocationSearch&&(o||a)){m=S.$eval(v.ngLocationSearch),m=y.isArray(m)?m:[v.ngLocationSearch];var i=null,c=function(a){i=1<m.length?{}:null,y.forEach(m,function(n,e){y.isObject(i)?i[n]=y.isDefined(a[n])?a[n]:null:y.isDefined(a[n])&&(i=a[n])}),y.isObject(i)&&(i=y.toJson(i)),(0,l(v.ngModel).assign)(S,i)},r=function(a){if(0<m.length){var n=S.$eval(v.ngSubmit);i={},y.forEach(m,function(n,e){y.isDefined(a[n])&&(i[n]=a[n])}),n=y.isObject(n)?n:{},i=y.extend(n,i),(0,l(v.ngSubmit).assign)(S,i)}};o&&(S.$watch(function(){return o.$modelValue},function(n,e){if(n!==e&&o.$valid)t(n);else{var a=v.name;p.$broadcast("ngLocationSearchChangeError","model",a,o)}}),S.$on("$locationChangeStart",function(n,e,a,o,t){c(C.search())}),c(C.search())),a&&(n.on("submit",function(){var n=S.$eval(v.ngSubmit),e=v.name,a=S.$eval(e);!n||a&&!a.$valid?p.$broadcast("ngLocationSearchChangeError","form",e,a):t(n)}),S.$on("$locationChangeStart",function(n,e,a,o,t){r(C.search())}),r(C.search()))}S.$on("$destroy",function(){y.isDefined(S[v.ngSubmit])&&delete S[v.ngSubmit]})}}}])}(window.angular);