!function(n){"use strict";n.module("ngLocationSearch",[]).directive("ngLocationSearch",["$timeout","$location","$window","$parse",function(i,e,t,o){return{restrict:"A",require:["?ngModel","?^form"],link:function(a,c,r,u){function l(n){return n.replace(/\/$/,"")}function f(o){if(o){var c={},u=a.$eval(r.ngLocationSearchReset),f=t.location.hash.replace(e.url(),""),h=l(t.location.href.replace(t.location.hash,""));try{var g=n.fromJson(o);o=g}catch(n){}n.forEach(s,function(i,e){var t=null;n.isObject(o)&&n.isDefined(o[i])?t=o[i]:n.isString(o)&&(t=o),c[i]=""!==t?t:null});var S=e.search();if(u||(c=n.extend({},S,c)),i(function(){e.search(c)}),r.ngLocationSearchUrl&&n.isString(r.ngLocationSearchUrl)){var d=l(r.ngLocationSearchUrl);if(d!==h){var $=d+"/"+l(f)+e.url();i(function(){e.search({}).replace()}),t.location.href=$}}}}var s=a.$eval(r.ngLocationSearch);s=n.isArray(s)?s:[r.ngLocationSearch];var h=u[0],g=u[1];if(r.ngLocationSearch&&(h||g)){var S=null,d=function(i){S=s.length>1?{}:null,n.forEach(s,function(e,t){n.isObject(S)?S[e]=n.isDefined(i[e])?i[e]:null:n.isDefined(i[e])&&(S=i[e])}),n.isObject(S)&&(S=n.toJson(S)),(0,o(r.ngModel).assign)(a,S)},$=function(i){var e=a.$eval(r.ngSubmit);!e&&n.isObject(e)||(n.isUndefined(a[r.ngSubmit])&&(a[r.ngSubmit]={}),n.forEach(s,function(e,t){n.isDefined(i[e])&&(a[r.ngSubmit][e]=i[e])}))};h&&(a.$watch(function(){return h.$modelValue},function(n,i){n!==i&&f(n)}),a.$on("$locationChangeStart",function(n,i,t,o,a){d(e.search())}),d(e.search())),g&&(c.on("submit",function(){var n=a.$eval(r.ngSubmit);n&&f(n)}),a.$on("$locationChangeStart",function(n,i,t,o,a){$(e.search())}),$(e.search()))}a.$on("$destroy",function(){n.isDefined(a[r.ngSubmit])&&delete a[r.ngSubmit]})}}}])}(window.angular);